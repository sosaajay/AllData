CREATE DATABASE DTDIGGER;
USE DTDIGGER;

CREATE TABLE CUSTOMERS(
CUSTOMERID INT PRIMARY KEY,
NAME VARCHAR(20),
EMAIL VARCHAR(50),
 ADDRESS VARCHAR (50)
 );
 INSERT INTO CUSTOMERS(CUSTOMERID, NAME, EMAIL, ADDRESS)
 VALUES
	 
(1, 'AYUSH', 'AYUSH320@GMAIL.COM', 'RAJKOT'),
(2, 'MAYANK', 'MAYANK10@GMAIL.COM', 'AMRELI'),
(3, 'SAHIL', 'SAHIL99@GMAIL.COM', 'AHEMDABAD'),
(4, 'MANSHI', 'MANSHI290@GMAIL.COM', 'RAJKOT'),
(5, 'SATYAM', 'SATYAM00@GMAIL.COM', 'BHUJ'),
(6, 'AKASH', 'AKASH98887@GMAIL.COM', 'AHEMDABAD');
    
 -- 1. Retrieve all customer details.
 
 SELECT * FROM CUSTOMERS;
 
-- 2. Update a customer’s address.
 
 UPDATE CUSTOMERS
 SET ADDRESS = 'MUMBAI'
 WHERE CUSTOMERID = 4;
 
UPDATE CUSTOMERS
 SET ADDRESS = 'RAJKOT'
 WHERE CUSTOMERID = 2;
 
 -- Delete a customer using their CustomerID.
 
 DELETE FROM CUSTOMERS WHERE CUSTOMERID = 2;
 
 -- Display all customers whose name is ‘Alice’.
 
 SELECT * FROM CUSTOMERS WHERE NAME = 'ALICE';
 
 CREATE TABLE ORDERS(
ORDERID INT PRIMARY KEY,
CUSTOMERID INT,
ORDER_DATE INT,
TOTAL_AMOUNT int,
FOREIGN KEY (CUSTOMERID)  REFERENCES CUSTOMERS (CUSTOMERID)
);

INSERT INTO ORDERS (ORDERID, CUSTOMERID, ORDER_DATE, TOTAL_AMOUNT)
VALUES
(1111, 1, 2025-12-22, 5000),
(2222, 2, 2025-11-21, 3500),
(3333, 3, 2025-12-20, 55000),
(4444, 4, 2025-10-19, 7822),
(5555, 5, 2025-12-15, 9000),
(6666, 6, 2025-12-17, 8900);

-- Retrieve all orders made by a specific customer.

 SELECT * FROM ORDERS WHERE CUSTOMERID =1;

-- Update an order’s total amount. 

UPDATE ORDERS
SET TOTAL_AMOUNT = 10000
WHERE ORDERID = 1111;

-- Delete an order using its OrderID.

DELETE FROM ORDERS WHERE ORDERID = 2222;

-- Retrieve orders placed in the last 30 days

SELECT * FROM ORDERS WHERE ORDER_DATE >= 2025-11-23;

CREATE TABLE PRODUCTS (
    PRODUCTID INT PRIMARY KEY,
    PRODUCTNAME VARCHAR(50),
    PRICE INT,
    STOCK INT,
    ORDERID INT,
    FOREIGN KEY (ORDERID) REFERENCES ORDERS(ORDERID)
);
INSERT INTO PRODUCTS (PRODUCTID, PRODUCTNAME, PRICE, STOCK, ORDERID)
VALUES
(101, 'MOBILE', 15000, 10, 1111),
(102, 'LAPTOP', 55000, 5, 3333),
(103, 'HEADPHONES', 1200, 20, 1111),
(104, 'KEYBOARD', 800, 15, 4444),
(105, 'MOUSE', 500, 0, 5555),
(106, 'MONITOR', 12000, 8, 6666);

-- Retrieve all products sorted by price in descending order.

SELECT * FROM PRODUCTS ORDER BY PRICE DESC;

-- Update the price of a specific product.
UPDATE PRODUCTS
SET PRICE = 2000
WHERE PRODUCTID = 103;

-- Delete a product if it’s out of stock.

DELETE FROM PRODUCTS WHERE STOCK = 0;

-- Retrieve products whose price is between ₹500 and ₹2000.

SELECT * FROM PRODUCTS WHERE PRICE >= 500 AND PRICE <= 2000;

-- Retrieve the most expensive and cheapest product using MAX() and MIN().

SELECT * FROM PRODUCTS WHERE PRICE = (SELECT MAX(PRICE) FROM PRODUCTS);
SELECT * FROM PRODUCTS WHERE PRICE = (SELECT MIN(PRICE) FROM PRODUCTS);

CREATE TABLE ORDERDETAILS (
    ORDERDETAILID INT PRIMARY KEY,
    ORDERID INT,
    PRODUCTID INT,
    QUANTITY INT,
    SUBTOTAL DECIMAL(10,2),
    FOREIGN KEY (ORDERID) REFERENCES ORDERS(ORDERID),
    FOREIGN KEY (PRODUCTID) REFERENCES PRODUCTS(PRODUCTID)
);
INSERT INTO ORDERDETAILS (ORDERDETAILID, ORDERID, PRODUCTID, QUANTITY, SUBTOTAL)
VALUES
(1, 1111, 101, 2, 30000.00),
(2, 1111, 103, 1, 1200.00),
(3, 3333, 102, 1, 55000.00),
(4, 4444, 104, 1, 800.00),
(5, 6666, 106, 2, 24000.00);

-- Retrieve all order details for a specific order.

SELECT * FROM ORDERDETAILS WHERE ORDERID = 1111;

-- Calculate the total revenue generated from all orders using SUM().

SELECT SUM(SUBTOTAL) TOTAL_REVENUE FROM ORDERDETAILS;

-- Retrieve the top 3 most ordered products

SELECT PRODUCTID, SUM(QUANTITY) TOTAL_QUANTITY FROM ORDERDETAILS
GROUP BY PRODUCTID
ORDER BY TOTAL_QUANTITY DESC
LIMIT 3;

-- Count how many times a specific product has been sold using COUNT().

SELECT COUNT(*) TIMES_SOLD FROM ORDERDETAILS WHERE PRODUCTID = 101;









